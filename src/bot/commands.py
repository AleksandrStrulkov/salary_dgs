import os
from dotenv import load_dotenv
from aiogram import Router, F, Bot, Dispatcher
from aiogram.types import Message, CallbackQuery
from aiogram.filters import Command, StateFilter
from bot.keyboards import show_full_result_kb, main_menu_kb, main_menu_start, get_back_finish_kb, combined_keyboard

router = Router()
used_users = set()
ADMIN_ID = int(os.getenv("ADMIN_ID"))
load_dotenv()


@router.message(Command("start"))
async def start_handler(message: Message):
    used_users.add(message.from_user.id)
    await message.answer(
            "üëã *–ü—Ä–∏–≤–µ—Ç!*\n"
            "üöÄ –Ø –ø–æ—Å—á–∏—Ç–∞—é *–í–∞—à—É –∑–∞—Ä–ø–ª–∞—Ç—É!* –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
            reply_markup=main_menu_kb, parse_mode="Markdown"
    )


@router.message(Command("stats"))
async def stats_handler(message: Message):
    if message.from_user.id == ADMIN_ID:
        await message.answer(
                f"üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –±–æ—Ç–æ–º: {len(used_users)}"
        )
    else:
        await message.answer("‚õîÔ∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤.")


@router.message(Command("help"))
async def stats_handler(message: Message):
    await message.answer(
            f"*1. –ü–†–ï–ú–ò–Ø:*\n"
            "–û—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–∫–ª–∞–¥–∞ - *40%*\n\n"
            "*2. –î–û–ü–õ–ê–¢–ê –ó–ê –†–ê–ë–û–¢–£ –í –ù–û–ß–ù–û–ï –í–†–ï–ú–Ø:*\n"
            "–û—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–∫–ª–∞–¥–∞ –∑–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è - *20%*\n"
            "–í –Ω–æ—á–Ω—É—é —Å–º–µ–Ω—É - *6—á.*\n"
            "–í –≤–µ—á–µ—Ä–Ω—é—é —Å–º–µ–Ω—É - *1,3—á.*\n\n"
            "*3. –ù–ê–î–ë–ê–í–ö–ê –ó–ê –í–†–ï–î–ù–´–ï –£–°–õ–û–í–ò–Ø –¢–†–£–î–ê:*\n"
            "–û—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–∫–ª–∞–¥–∞ - *4%*\n\n"
            "*4. –î–û–ü–õ–ê–¢–ê –ó–ê –†–ê–ë–û–¢–£ –í –í–´–†–ê–ë–û–¢–ö–ê–• –° –¢–ï–ú–ü–†–ï–¢–£–†–û–ô –í–û–ó–î–£–•–ê –û–¢ +26 –î–û +30–°:*\n"
            "–û—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–∫–ª–∞–¥–∞ - *10%*\n\n"
            "*5. –†–ê–ô–û–ù–ù–´–ô –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢:*\n"
            "–ü—É–Ω–∫—Ç—ã —Ä–∞—Å—á–µ—Ç–∞ 1,2,3,4 —Å—É–º–º–∏—Ä—É—é—Ç—Å—è,\n"
            "–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞–¥–±–∞–≤–∫–∞ –æ—Ç —ç—Ç–æ–π —Å—É–º–º—ã - *30%*\n\n"
            "*6. –°–ï–í–ï–†–ù–ê–Ø –ù–ê–î–ë–ê–í–ö–ê:*\n"
            "–ü—É–Ω–∫—Ç—ã —Ä–∞—Å—á–µ—Ç–∞ 1,2,3,4 —Å—É–º–º–∏—Ä—É—é—Ç—Å—è,\n"
            "–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞–¥–±–∞–≤–∫–∞ –æ—Ç —ç—Ç–æ–π —Å—É–º–º—ã - *50%*\n\n"
            "*7. –û–ü–õ–ê–¢–ê –í –î–í–û–ô–ù–û–ú –†–ê–ó–ú–ï–†–ï:*\n"
            "–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º–∏ –¥–Ω—è–º–∏ –∏ –Ω–æ—Ä–º–æ–π\n"
            "—Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ –º–µ—Å—è—Ü –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ –¥–≤–æ–π–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ.\n"
            "–ü–µ—Ä–≤–∞—è –æ–ø–ª–∞—Ç–∞ - –≤ –º–µ—Å—è—Ü —Ä–∞—Å—á–µ—Ç–∞ —Å–æ –≤—Å–µ–º–∏ –Ω–∞–¥–±–∞–≤–∫–∞–º–∏,\n"
            "–í—Ç–æ—Ä–∞—è –æ–ø–ª–∞—Ç–∞ - –≤ —Ä–∞—Å—á–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∫–≤–∞—Ä—Ç–∞–ª–∞ –±–µ–∑ –Ω–∞–¥–±–∞–≤–æ–∫.\n\n"
            "*8. –ù–ê–õ–û–ì–û–í–´–ô –í–´–ß–ï–¢ –ù–ê –î–ï–¢–ï–ô:*\n"
            "–ù–∞ –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ - *1400 ‚ÇΩ*\n"
            "–ù–∞ –≤—Ç–æ—Ä–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ - *1600 ‚ÇΩ*\n"
            "–ù–∞ —Ç—Ä–µ—Ç—å–µ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö - *6000 ‚ÇΩ*\n"
            "–ï—Å–ª–∏ –Ω–∞ –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ –Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç —É–∂–µ –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è, "
            " —Ç–æ –Ω–∞ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –¥–µ—Ç–µ–π —Å—É–º–º–∞ –≤—ã—á–µ—Ç–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è.\n"
            "–°—Ç–æ–∏—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –Ω–∞–ª–æ–≥–æ–≤—ã–π –≤—ã—á–µ—Ç –Ω–∞ –¥–µ—Ç–µ–π\n*–Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º!*\n"
            "–ü—Ä–µ–¥–µ–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥, –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —É —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∞–≤–æ "
            " –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞–∫–∏—Ö –≤—ã—á–µ—Ç–æ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç:\n- *450 000 ‚ÇΩ*", parse_mode="Markdown"
    )